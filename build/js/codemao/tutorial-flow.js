function buildStandardFlow(){taskFlow.tastArr=[tutorialFlow.showCutScenes(tutorialFlow.showMissionWindow)],taskFlow.start()}function buildInteractionFlow(){taskFlow.tastArr=[tutorialFlow.showCutScenes,tutorialFlow.showMissionWindow,tutorialFlow.playTutorialVideo,function(e){var t=createBackground({backgroundImage:"radial-gradient(50px 50px at 25px 231px, hsla(0, 100%, 100%,0), hsla(0, 100%, 100%,0) 90%, hsla(0, 0%, 0%, 0.6))",shadowBoxCssText:"width: 70px;top: 193px;height: 70px; position: absolute;"});t.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat 0px 0px;width: 268px;height: 201px;margin-left: 80px;margin-top: 30px;"></div>',t.shadowBox.addEventListener("click",function(){document.body.removeChild(t.bg),e()})},function(e){var t=createBackground({backgroundImage:"radial-gradient(50px 50px at 210px 100%, hsla(0, 100%, 100%,0), hsla(0, 100%, 100%,0) 90%, hsla(0, 0%, 0%, 0.6))",shadowBoxCssText:"width: 100px;bottom: 0px;left:170px;height: 50px; position: absolute;"});t.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat 0px -642px;width: 268px;height: 199px;margin-left: 80px;margin-top: -120px;"></div>',t.shadowBox.addEventListener("click",function(){document.querySelector("#ide-corral .sprite-add").click(),document.body.removeChild(t.bg),e()})},function(e){setTimeout(function(){var t=document.querySelector('img[src="http://7xq5t9.com2.z0.glb.qiniucdn.com/Fv8f1Xe5mi2nafha2Ox7llIO_sZ_"]'),o=t.getBoundingClientRect().left,i=t.getBoundingClientRect().top,n=createBackground({backgroundImage:"radial-gradient(150px 150px at "+(i+80)+"px "+(o+80)+"px, hsla(0, 100%, 100%,0), hsla(0, 100%, 100%,0) 90%, hsla(0, 0%, 0%, 0.6))",shadowBoxCssText:"width: 300px;top: "+(i-75)+"px;left:"+(o-75)+"px;height: 300px; position: absolute;",zIndex:1500});n.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat -362px -400px;width: 268px;height: 199px;margin-left: 280px;margin-top: -60px;"></div>',n.shadowBox.addEventListener("click",function(){t.click(),document.body.removeChild(n.bg),setTimeout(function(){e()},1e3)})},0)},function(e){var t=createBackground({backgroundImage:"radial-gradient(50px 50px at 25px 130px, hsla(0, 100%, 100%,0), hsla(0, 100%, 100%,0) 90%, hsla(0, 0%, 0%, 0.6))",shadowBoxCssText:"width: 70px;top: 90px;height: 80px; position: absolute;"});t.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat 0px -211px;width: 268px;height: 201px;margin-left: 80px;margin-top: 30px;"></div>',t.shadowBox.addEventListener("click",function(){document.querySelector(".sidebar-btn.tips-btn").click(),document.body.removeChild(t.bg),e()})},function(e){function t(){document.body.querySelector("#world-wrapper").removeChild(o),document.body.querySelector("#ide-sidebar-wrapper .sidebar").removeChild(i),document.body.querySelectorAll("#ide-sidebar-wrapper .slider .slider-row")[2].removeChild(n),document.body.querySelector("#ide-header").removeChild(a),document.body.removeEventListener("click",t),e()}var o=document.createElement("div");o.style.cssText="position: absolute;z-index:100;left: 0;right: 0;bottom: 0;top: 0;background-color: hsla(0, 0%, 0%, 0.6);",document.body.querySelector("#world-wrapper").appendChild(o);var i=document.createElement("div");i.style.cssText="position: absolute;left: 0;right: 0;bottom: 0;top: 0;background-color: hsla(0, 0%, 0%, 0.6);",document.body.querySelector("#ide-sidebar-wrapper .sidebar").appendChild(i);var n=document.createElement("div");n.style.cssText="position: absolute;left: 0;right: 0;bottom: 0;top: 0;background-color: hsla(0, 0%, 0%, 0.6);",document.body.querySelectorAll("#ide-sidebar-wrapper .slider .slider-row")[2].appendChild(n);var a=document.createElement("div");a.style.cssText="position: absolute;left: 0;right: 0;bottom: 0;top: 0;z-index:1000;background-color: hsla(0, 0%, 0%, 0.6);",document.body.querySelector("#ide-header").appendChild(a),o.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat 0px -422px;width: 268px;height: 201px;margin-left: 20px;margin-top: 200px;"></div>',setTimeout(function(){document.body.addEventListener("click",t)},0)},function(e){var t=createBackground({backgroundImage:"radial-gradient(80px 30px at 210px 95%, hsla(0, 100%, 100%, 0.1), hsla(0, 100%, 100%,0) 90%, hsla(0, 0%, 0%, 0.601961))",shadowBoxCssText:"width: 120px;bottom: 10px;left: 149px;height: 80px; position: absolute;"});t.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat -366px 0px;width: 268px;height: 199px;position: absolute;bottom: 80px;left: 100px;"></div>',t.shadowBox.addEventListener("click",function(){document.body.removeChild(t.bg)})},function(e){var t=document.querySelector(".header-button.ide-submit"),o=t.getBoundingClientRect().left,i=createBackground({backgroundImage:"radial-gradient(50px 40px at "+(o+45)+"px 20px, hsla(0, 0%, 100%, 0.0980392),hsla(0, 0%, 100%, 0.0980392) 90%, hsla(0, 0%, 0%, 0.601961))",shadowBoxCssText:"width: 60px;top: 0px;right: 70px;height: 60px; position: absolute;"});i.shadowBox.innerHTML='<div style="pointer-events: none;background: url(http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Finteraction-figure2.png) no-repeat -362px -209px;width: 272px;height: 181px;margin-top: 50px;margin-left: -320px;"></div>',i.shadowBox.addEventListener("click",function(){document.body.removeChild(i.bg),t.click()})}],taskFlow.start()}function createBackground(e){var t={backgroundImage:"radial-gradient(100px 100px at 50% 50%,hsl(0, 100%, 100%),hsla(0, 0%, 0%, 0.77))",zIndex:"500",shadowBoxCssText:"width:200px;height:200px;position:absolute;left:50%;top:50%;margin-left:-100px;margin-top:-100px;"};e=e||{};var o=document.createElement("div");o.style.cssText="position:fixed;left:0;right:0;top:0;bottom:0;",o.style.backgroundImage=e.backgroundImage||t.backgroundImage,o.style.zIndex=e.zIndex||t.zIndex;var i=document.createElement("div");return i.style.cssText=e.shadowBoxCssText||t.shadowBoxCssText,i.style.cursor="pointer",o.appendChild(i),document.body.appendChild(o),{shadowBox:i,bg:o}}var tutorialFlow={};!function(){"use strict";var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href="css/tutorial-flow.css",document.head.appendChild(e);var t=document.createElement("div");t.className="scene-wrapper",tutorialFlow.showCutScenes=function(e){if(""==codemao.video)return void e();t.innerHTML="";var o=document.createElement("div");o.className="video-wrapper",o.innerHTML='<video preload="none" style="height:100%;" src="'+codemao.video+'" autoplay controls></video>';var i=document.createElement("div");i.className="video-skip-btn",o.appendChild(i),t.appendChild(o),document.body.appendChild(t),i.addEventListener("click",function(){document.body.removeChild(t),"function"==typeof e&&e()}),o.querySelector("video").addEventListener("ended",function(){i.click()})},tutorialFlow.showMissionWindow=function(e){t.innerHTML="";var o=document.createElement("div");o.className="preview-award-window",o.innerHTML='<div class="header">任务面板</div><p class="level-text">'+codemao.taskTitle+'</p><div class="left-part"><p class="mission-target-text">任务目标:</p><p class="mission-target-content">'+codemao.taskTarget+'</p><p class="mission-award-text">任务奖励:</p><div class="award-item-wrapper"></div></div><div class="right-part"><video autoplay controls style="width: 100%;height: 100%;" class="preview-game" src="'+codemao.videoEffect+'"></video></div><img src="http://7xli7a.com2.z0.glb.qiniucdn.com/images%2Fjiantou.svg" style="position: absolute;left: 50%;margin-left: -11px;top: 50%;margin-top: -35px;width: 58px;"><div class="accept-btn-wrapper"><button class="accept-btn">接受</button></div>';var i=o.querySelector(".award-item-wrapper");codemao.reward.forEach(function(e){var t=document.createElement("div");t.style.cssText="display:inline-block;width:80px;height:80px;margin:8px 8px 0 20px;background-size: contain;position:relative;",t.style.backgroundImage="url("+e.img+")",t.innerHTML='<span style="position: absolute;top: 100%;left: 0;width: 100%;text-align: center;line-height: normal;text-indent: 0;color: hsl(50, 72%, 50%);">'+e.name+"x"+e.number+"</span>",1==e.isSprite&&t.setAttribute("data-sprite","1"),i.appendChild(t)}),t.appendChild(o),document.body.appendChild(t),o.querySelector(".accept-btn").addEventListener("click",function(){document.body.removeChild(t),"function"==typeof e&&e()})},tutorialFlow.showResultAward=function(e){t.innerHTML="";var o=document.createElement("div");o.className="award-window",o.innerHTML='<div class="window-title">领取奖励<i class="fa fa-times close-btn" style="float: right;font-size: 20px;margin-right: 8px;margin-top: 4px;cursor: pointer;"></i></div><div class="row award-item-row"><p  class="mission-name">'+codemao.taskTitle+'</p><p class="get-award-text">获得奖励:</p><div class="award-item-wrapper"></div></div><div class="next-level-btn-wrapper" ><button class="next-level-btn">进入下一关</button></div><p class="back-to-lesson-page"><a href="/lesson" style="color:hsl(0, 0%, 60%);">返回大厅</a></p>';var i=o.querySelector(".award-item-wrapper");codemao.reward.forEach(function(e){var t=document.createElement("div");t.style.cssText="display:inline-block;margin:8px 8px 0 20px;width:64px;height:64px;background-size:contain;position:relative;",t.style.backgroundImage="url("+e.img+")",t.className="award-item",t.innerHTML='<span class="number-text">'+e.name+"x"+e.number+"</span>",i.appendChild(t)}),o.querySelector(".next-level-btn").addEventListener("click",function(){location.href="/program/"+(parseInt(parseHash().lesson)+1)}),o.querySelector(".close-btn").addEventListener("click",function(){document.body.removeChild(t),"function"==typeof e&&e()}),t.appendChild(o),document.body.appendChild(t)};var o;tutorialFlow.buildTutorialVideo=function(e){t.innerHTML="",o=document.createElement("video"),o.setAttribute("preload","none"),o.src=codemao.videoTutorial,o.setAttribute("controls","true"),o.setAttribute("loop","loop");var i=document.createElement("div");i.innerHTML="x",i.className="close-tutorial-video-btn",i.addEventListener("click",function(){tutorialFlow.playTutorialVideo(),"function"==typeof e&&e()}),t.innerHTML="";var n=document.createElement("div");n.className="video-wrapper tutorial",n.appendChild(o),n.appendChild(i),t.appendChild(n)},tutorialFlow.playTutorialVideo=function(e){"undefined"==typeof o&&tutorialFlow.buildTutorialVideo(e),o.paused?(o.play(),document.body.appendChild(t),window.statistics.videoRecording("play")):(o.pause(),document.body.removeChild(t),window.statistics.videoRecording("pause"))}}(tutorialFlow);var taskFlow=function(){function e(){t.tastArr[o](e),o++}var t={};t.tastArr=[];var o=0;return t.start=function(){e()},t}();window.addEventListener("load",function(){1!=codemao.isPass?1==parseHash().lesson?buildInteractionFlow():buildStandardFlow():tutorialFlow.showCutScenes()});